{% extends 'base.html' %}
{% load static %}



{% block content %}
<link rel="stylesheet" href="{% static 'css/project_detail.css' %}">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css">
<div class="project-detail-container">
    <!-- Project Header -->
    <div class="project-header animate__animated animate__fadeIn">
        <div class="project-header-content">
            <h1 class="project-title gradient-text">{{ project.title }}</h1>
            <p class="project-category">{{ project.category.name }}</p>
            <p class="project-creator">By <strong>{{ project.creator.get_full_name }}</strong></p>
        </div>
        <div class="project-image">
            {% if project.image %}
                <img src="{{ project.image.url }}" alt="{{ project.title }}" class="animate__animated animate__zoomIn">
            {% else %}
                <img src="{% static 'images/default-project.jpg' %}" alt="Default Image" class="animate__animated animate__zoomIn">
            {% endif %}
        </div>
    </div>

    <!-- Funding Section -->
    <div class="funding-section animate__animated animate__fadeInUp">
        <div class="funding-card">
            <div class="progress-bar-container">
                <div class="progress-bar" style="width: {{ project.progress }}%"></div>
            </div>
            <div class="funding-stats">
                <div class="stat">
                    <span class="stat-value">{{ project.total_donations|floatformat:2 }} EGP</span>
                    <span class="stat-label">Raised</span>
                </div>
                <div class="stat">
                    <span class="stat-value">{{ project.total_target|floatformat:2 }} EGP</span>
                    <span class="stat-label">Goal</span>
                </div>
                <div class="stat">
                    <span class="stat-value">{{ project.progress|floatformat:0 }}%</span>
                    <span class="stat-label">Progress</span>
                </div>
                <div class="stat">
                    <span class="stat-value">{{ project.days_left }}</span>
                    <span class="stat-label">Days Left</span>
                </div>
            </div>
        </div>
    </div>

    <!-- Project Details -->
    <div class="project-details animate__animated animate__fadeInUp">
        <h2 class="section-title">Project Details</h2>
        <p class="project-description">{{ project.details|linebreaks }}</p>
        {% if project.tags.all %}
        <div class="project-tags">
            <h3>Tags:</h3>
            <div class="tags">
                {% for tag in project.tags.all %}
                <span class="tag">{{ tag.name }}</span>
                {% endfor %}
            </div>
        </div>
        {% endif %}
    </div>

    <!-- Actions Section -->
    <div class="actions-section animate__animated animate__fadeInUp">
        <a href="{% url 'projects:donate' project.pk %}" class="btn btn-primary">
            <i class="fas fa-donate"></i> Donate Now
        </a>
        {% if user == project.creator and project.can_be_cancelled %}
        <form method="post" action="{% url 'projects:project-cancel' project.pk %}" class="cancel-form">
            {% csrf_token %}
            <button type="submit" class="btn btn-danger">
                <i class="fas fa-times"></i> Cancel Project
            </button>
        </form>
        {% endif %}
    </div>

    <!-- Similar Projects -->
    <div class="similar-projects animate__animated animate__fadeInUp">
        <h2 class="section-title">Similar Projects</h2>
        <div class="projects-grid">
            {% for project in similar_projects %}
            <div class="project-card">
                <div class="project-card-image">
                    {% with project.pictures.all|first as first_image %}
                    <img src="{% if first_image %}{{ first_image.image.url }}{% else %}{% static 'images/default-project.jpg' %}{% endif %}" 
                         alt="{{ project.title }}">
                    {% endwith %}
                </div>
                <div class="project-card-content">
                    <h3 class="project-card-title">{{ project.title }}</h3>
                    <p class="project-card-category">{{ project.category.name }}</p>
                    <a href="{% url 'projects:project-detail' project.pk %}" class="btn btn-secondary">View Details</a>
                </div>
            </div>
            {% empty %}
            <p>No similar projects found.</p>
            {% endfor %}
        </div>
    </div>
</div>
{% endblock %}

{% block js %}
<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.9.1/gsap.min.js"></script>
<script>
document.addEventListener('DOMContentLoaded', function() {
    // Add animations to elements
    gsap.from('.project-header', { duration: 1, opacity: 0, y: -50 });
    gsap.from('.funding-section', { duration: 1, opacity: 0, y: 50, delay: 0.5 });
    gsap.from('.project-details', { duration: 1, opacity: 0, y: 50, delay: 1 });
    gsap.from('.actions-section', { duration: 1, opacity: 0, y: 50, delay: 1.5 });
});
</script>
{% endblock %}